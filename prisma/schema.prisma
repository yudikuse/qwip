// =========================
// Prisma Schema COMPLETO
// =========================

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"       // Supabase/Neon/Postgres
  url      = env("DATABASE_URL")
}

// =========================
// MODELS
// =========================

model Seller {
  id        String   @id @default(cuid())
  // Estes campos ficam OPCIONAIS para não quebrar as 3 linhas já existentes:
  name      String?
  phone     String?
  createdAt DateTime @default(now())

  ads       Ad[]

  @@index([phone])
}

model Ad {
  id           String   @id @default(cuid())
  title        String
  description  String
  priceCents   Int
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt

  // ===== Campos que já existiam no seu banco =====
  city        String
  uf          String
  lat         Float
  lng         Float
  centerLat   Float?
  centerLng   Float?
  radiusKm    Float?
  expiresAt   DateTime?
  isActive    Boolean  @default(true)

  // Relacionamento com Seller (já existia sellerId)
  sellerId   String?
  seller     Seller?  @relation(fields: [sellerId], references: [id])

  // ===== Novos campos de IMAGEM (opcionais) =====
  imageUrl     String?           // URL pública no storage (ex.: Vercel Blob)
  imageMime    String?           // ex.: "image/jpeg", "image/png"
  imageWidth   Int?
  imageHeight  Int?
  imageSha256  String?           // hash para dedupe/antiabuso

  // Índices
  @@index([imageSha256])
  @@index([city, uf])
  @@index([isActive, expiresAt])
}
